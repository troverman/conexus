<style>.ngCytoscape{height: 200px;width:100%;}</style>

<div class="container" style="padding:0px">
    <div class="card" ng-click="cardDetailToggle(item)">
        <div class="imageContainerSmall" style="background:url('https://source.unsplash.com/1600x900/?{{item.tags}}');">
            <div style="background:rgba(0,0,0,0.75);" class="imageContainerSmallDiv">
                <div style="text-align:right;padding:15px;position:absolute;right:0">
                    <a style="color:white;" ng-click="$event.stopPropagation();cardDetailToggle(item)">
                        <i class="fas fa-chevron-down"></i>
                    </a>
                </div>
                <div style="margin-top: auto;margin-bottom: auto;text-align:center">
                    <div style="padding:15px">
                        <h1>
                            {{item.title}}
                        </h1>
                        <h5 style="color:white">{{item.id}}</h5>
                    </div>
                </div>
            </div>
        </div>
        <div ng-show="markers.length>0">
            <ui-gmap-google-map center="map.center" zoom="map.zoom" options="options">
                <ui-gmap-marker ng-repeat="marker in markers" coords="marker.coords" options="marker.options" idkey="marker.id">
                    <ui-gmap-window options="windowOptions" closeClick="closeClick()">
                        <div>
                            <div style="font-size: 15px;"><a ng-click="$event.stopPropagation();" href="item/{{market.id}}">{{marker.content}}</a></div>
                        </div>
                    </ui-gmap-window>
                </ui-gmap-marker>
            </ui-gmap-google-map>
        </div>
        <div style="background-color:white">
            <div class="member-tab-container container" style="padding-left:0px">
                <div style="text-align:center">
                    <ul style="padding:0px;" class="member-tabs">
                        <li><a ng-click="$event.stopPropagation();selectTab('ACTIVITY')">Activity</a></li>
                        <li><a ng-click="$event.stopPropagation();selectTab('ACTIONS')">Actions</a></li>
                        <li><a ng-click="aselectTab('ASSOCIATIONS')" href="#">Associations</a></li>
                        <li><a ng-click="aselectTab('CONTENT')" href="#">Content</a></li>
                        <li><a ng-click="$event.stopPropagation();selectTab('COMPONENTS')">Components</a></li>
                        <li><a ng-click="$event.stopPropagation();selectTab('HISTORY')" >History</a></li>
                        <li><a ng-click="$event.stopPropagation();selectTab('LIQUIDITY')">Liquidity</a></li>
                        <li><a ng-click="aselectTab('STATS')" href="#">Stats</a></li>
                        <li><a ng-click="aselectTab('TOKENS')" href="#">Tokens</a></li>
                        <li><a ng-click="$event.stopPropagation();orderToggle(null, item);" class="btn btn-default">Purchase</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <hr style="margin:0px;">
        <div style="padding:16px;">
            <div>
                <img class="card-avatar" ng-src="{{item.user.avatarUrl}}" src="{{item.user.avatarUrl}}" err-src="/images/avatar.png">
                <a ng-click="$event.stopPropagation();" style="display:inline" href="member/{{item.user.username}}" ui-sref="member.activity({path:item.user.username})"><span style="font-weight:800">{{item.user.username}}</span></a>
            </div>
            <div class="spacing-5"></div>
            <p><a ng-repeat="tag in item.tags track by $index" ng-click="$event.stopPropagation();filterContent(tag)">{{tag.trim()}} </a></p>
            <div class="spacing-5"></div>
            <div ng-click="$event.stopPropagation();"><span style="display:inline" ng-bind-html="renderContent(item.content)"></span></div>
            <div class="spacing-5"></div>       
        </div>
        <div class="card-footer">
            <!--TODO: AGNOSTIC REACTION(S) AND CONTROLLER-->
            <!--REACT SIDEBAR-->
            <a style="color:grey" href="content/{{item.id}}" ui-sref="content({id:item.id})"> {{item.attention.general || 0}} <i class="fas fa-eye"></i></a>
            <a ng-click="$event.stopPropagation();createReaction(item, 'plus')"><i class="fas fa-angle-up"></i> {{item.reactions.plus}} like </a> 
            <a ng-click="$event.stopPropagation();createReaction(item, 'minus')" ><i class="fas fa-angle-down"></i> {{item.reactions.minus}} dislike </a>
            <a ng-click="$event.stopPropagation();contentToggle(item)"><i class="far fa-comment"></i> comment </a>
        </div>
    </div>
</div>

<div class="container">
	<div class="row">

        <!--ACTIONS-->
        <div ng-if="selectedTab =='ACTIONS'"  class="card">
            <div style="background:url('https://source.unsplash.com/1600x900/?blueprint,code,parts,components,designs')" class="imageContainerSmall">
                <div style="background:rgba(0,0,0,0.75)" class="imageContainerSmallDiv">  
                    <div style="margin-top: auto;margin-bottom: auto;">
                        <div style="padding:15px">
                            <h1 style="text-align:left;font-size:35px;color:rgba(255,255,255,0.9);font-weight:400;">Actions</h1>
                        </div>
                    </div>
                </div>
            </div>
            <div style="padding:16px">   

                <div class="card">
                    <button type="submit" class="btn btn-default log-btn" ng-click="actionToggle(item)">+ Action</button>
                </div>

            </div>
        </div>

        <!--ASSOCIATIONS-->
        <div ng-if="selectedTab =='ASSOCIATIONS'"  class="card"></div>

        <!--HISTORY-->
        <div ng-if="selectedTab =='HISTORY'"  class="card">
            <div style="background:url('https://source.unsplash.com/1600x900/?code,exchange,history,item,transaction')" class="imageContainerSmall">
                <div style="background:rgba(0,0,0,0.75)" class="imageContainerSmallDiv">  
                    <div style="margin-top: auto;margin-bottom: auto;">
                        <div style="padding:15px">
                            <h1 style="text-align:left;font-size:35px;color:rgba(255,255,255,0.9);font-weight:400;">History</h1>
                        </div>
                    </div>
                </div>
            </div>
            <div style="padding:16px">

                <div style="float:right;text-align:right">
                    <a style="color:gray;" ng-click="$event.stopPropagation();cardDetailToggle(transaction)"><span style="color:gray"></span><i class="fa fa-ellipsis-v"></i></a>
                </div>

                <!--CREATOR-->
                <h5>Item Created: {{item.createdAt | date}}</h5>
                <div class="spacing-10"></div>

                <div ng-repeat="transaction in transactions">
    
                    <div style="display:inline">
                        <span ng-if="transaction.from.username">
                            <a ng-click="$event.stopPropagation()"  style="display:inline;font-weight:600;margin-left:5px" href="member/{{transaction.from.username}}" ui-sref="member.activity({path:transaction.from.username})">
                                <img class="card-avatar" ng-src="{{transaction.from.avatarUrl}}" src="{{transaction.from.avatarUrl}}" err-src="/images/avatar.png">
                                {{transaction.from.username}}
                            </a>
                        </span>
                        <span ng-if="transaction.from.title">
                            <a ng-click="$event.stopPropagation()"  style="display:inline;font-weight:600;margin-left:5px" href="project/{{transaction.from.urlTitle}}" ui-sref="project.activity({path:transaction.from.title})">
                                <img class="card-avatar" ng-src="{{transaction.from.avatarUrl}}" src="{{transaction.from.avatarUrl}}" err-src="/images/avatar.png">
                                {{transaction.from.title}}
                            </a>
                        </span>
                    </div>
                    <div style="display:inline;padding-left:5px;padding-right:5px;">
                        <i class="fa fa-arrow-right"></i>
                    </div>
                    <div style="display:inline">
                        <span ng-if="transaction.to.username">
                            <a ng-click="$event.stopPropagation()"  style="display:inline;font-weight:600;margin-left:5px" href="member/{{transaction.to.username}}" ui-sref="member.activity({path:transaction.to.username})">
                                <img class="card-avatar" ng-src="{{transaction.to.avatarUrl}}" src="{{transaction.to.avatarUrl}}" err-src="/images/avatar.png">
                                {{transaction.to.username}}
                            </a>
                        </span>
                        <span ng-if="transaction.to.title">
                            <a ng-click="$event.stopPropagation()"  style="display:inline;font-weight:600;margin-left:5px" href="project/{{transaction.to.urlTitle}}" ui-sref="project.activity({path:transaction.to.title})">
                                <img class="card-avatar" ng-src="{{transaction.to.avatarUrl}}" src="{{transaction.to.avatarUrl}}" err-src="/images/avatar.png">
                                {{transaction.to.title}}
                            </a>
                        </span>
                    </div>

                    <div class="spacing-5"></div>
                                
                    <span ng-repeat="(key, value) in transaction.amountSet"><p style="font-weight:800">{{value}} <a ng-click="$event.stopPropagation();" href="market/{{key}}" ui-sref="market({id:key})">{{key}}</a></p></span>

                    <p><a ng-repeat="tag in transaction.ledger.split(',')" href="market/{{tag.trim()}}" ui-sref="market({id:tag.trim()})">{{tag.trim()}} </a></p>
                    <p>{{transaction.content}}</p>

                </div>

            </div>
        </div>

        <!--COMPONENTS-->
        <div ng-if="selectedTab =='COMPONENTS'"  class="card">
            <div style="background:url('https://source.unsplash.com/1600x900/?blueprint,code,parts,components,designs')" class="imageContainerSmall">
                <div style="background:rgba(0,0,0,0.75)" class="imageContainerSmallDiv">  
                    <div style="margin-top: auto;margin-bottom: auto;">
                        <div style="padding:15px">
                            <h1 style="text-align:left;font-size:35px;color:rgba(255,255,255,0.9);font-weight:400;">Components</h1>
                        </div>
                    </div>
                </div>
            </div>
            <div style="padding:16px">   
                <!--ITEM ITEM ASSOCIATION-->
                <h5>Component Graph</h5>
                <h5>Single Item</h5>
            </div>
        </div>

        <!--LIQUIDITY-->
        <!--CONNECT PURCHASE TO ORDER FUILFUILMENT AND CONNECTIONG PROTOS > > >-->
        <!--IF LIQDUID OR NOT .. AKA IF SELL ORDER FOR TOKEN NFT ..-->
        <!--ORDER FUILFILMENT COMES FROM LINKED INFO IN ORDER-->
        <!--ADDRESS.. NAME PARAM-->
        <!--PURCHASE NEEDS TO BE VERY.. EASY..-->
        <!--MARKET | TRAVERSAL-->
        <div ng-if="selectedTab =='LIQUIDITY'">

            <div class="card">
                <div style="background:url('https://source.unsplash.com/1600x900/?code,exchange,cash,finance,graphs,explore')" class="imageContainerSmall">
                    <div style="background:rgba(0,0,0,0.75)" class="imageContainerSmallDiv">  
                        <div style="margin-top: auto;margin-bottom: auto;">
                            <div style="padding:15px">
                                <h1 style="text-align:left;font-size:35px;color:rgba(255,255,255,0.9);font-weight:400;">Liquidity</h1>
                                <h5><a style="color:white" href="market/{{item.id}}" ui-sref="market({id:item.id})">{{item.id}} Market</a></h5>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="padding:16px">

                    <div class="card">
                        <button type="submit" class="btn btn-default log-btn" ng-click="orderToggle(item)">+ Order</button>
                    </div>

                    <div ng-if="orders.length > 0">
                        <div ng-repeat="input in inputVector">
                            <div layout="">
                                <div flex="10" layout="" layout-align="center center"><span class="md-body-1">{{input.text}}</span></div>
                                <md-slider step="0.1" flex="" md-discrete="" ng-model="inputVectorWeight[$index]" step="1" min="0" max="100" aria-label="{{input}}"></md-slider>
                                <div flex="10" layout="" layout-align="center center"><span class="md-body-1">{{inputVectorWeight}}</span></div>
                            </div>
                        </div>

                        <cytoscape graph-options="options" graph-elements="elementsObj" graph-layout="layout" graph-style="style"></cytoscape>

                        <!--<h5>InputVector: <span ng-repeat="input in inputVector"><a href="market/{{input}}">{{input.text}}</a> </span>-->
                        <!--NEED TO DO HIGH DIMENSIONAL TRANING.. LEARNING SETS ARE REAL TRAVERSALS.. JUST DO INPUT OUTPUT VECTORS: BULK TRAIN--> 
                        <!--<h5>OutputVector: {{item.amountSet}} <span ng-repeat="output in outputVector"><a href="market/{{output}}">{{output.text}}</a> </span>-->

                        <form ng-submit="marketTraverse(tokens, outputVector)">
                            <tags-input min-length="1" placeholder="Input Vector" ng-model="inputVector"></tags-input>
                            <tags-input min-length="1" placeholder="Output Vector" ng-model="outputVector"></tags-input>
                        </form>
                        <!--TRAVERSAL PARAMETERS-->
                        <p ng-repeat="result in marketOutput" style="color:gray;font-style:italic;font-size:10px">
                            <span>[tokens] = {{result[0]}} <a href="market/{{result[1]}}" ui-sref="market({id:result[1]})">{{result[1]}}</a></span>
                            <!--[IDENTITY] == 100% EACH .. OR WEIGHTED.. OR..-->
                        </p>


                        <!--IE TABLES FOR MARKET LOOKS-->

                        <!--VALUE MATRIX HERE-->
                    </div>



                </div>
            </div>

            <!--POTIENTALLY (EMBED) MARKET HERE-->
            <div ng-repeat="item in orders">
                <div class="card" ng-click="cardDetailToggle(item)">
                    <div style="background:url('https://source.unsplash.com/1600x900/?');min-height:100px" class="imageContainerSmall">
                        <div style="background:rgba(0,0,0,0.75);height:100px" class="imageContainerSmallDiv">  
                            <div style="text-align:right;padding:15px;position:absolute;right:0">
                                <a style="color:white;" ng-click="$event.stopPropagation();cardDetailToggle(item)">
                                    <i class="fas fa-chevron-down"></i>
                                </a>
                                <div style="clear:both"></div>
                            </div> 
                            <div style="margin-top: auto;margin-bottom: auto;">
                                <div class="container">
                                    <span ng-repeat="(key, value) in item.setAlpha">
                                        <a style="color:white;font-weight:700" href="market/{{key}}" ui-sref="market({id:key})">{{key}}</a>
                                    </span>
                                    <br>
                                    <span ng-repeat="(key, value) in item.setBeta">
                                        <a style="color:white;font-weight:700" href="market/{{key}}" ui-sref="market({id:key})">{{key}}</a>
                                    </span>
                                    <h5 style="color:white;font-weight:400"><span style="font-size:10px">{{item.type}}</span></h5>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="padding:16px">
                       
                        <p>
                            <a ng-click="$event.stopPropagation();renderReputationToggle(item)" style="display:inline">
                                <img class="card-avatar" ng-src="{{item.user.avatarUrl}}" src="{{item.user.avatarUrl}}" err-src="/images/avatar.png">
                                <span style="font-weight:800">{{item.user.username}}</span>
                            </a>
                        </p>

                        <div class="spacing-10"></div>

                        <div class="row">
                            <div class="col-sm-6" style="padding:0px">
                                <div class="card">
                                    <div style="background:url('https://source.unsplash.com/1600x900/?explore,discover,alpha,asset');min-height:100px" class="imageContainerSmall">
                                        <div style="background:rgba(0,0,0,0.75);height:100px" class="imageContainerSmallDiv">  
                                            <div style="margin-top: auto;margin-bottom: auto;">
                                                <div style="padding:15px">
                                                    <h2 style="color:white">Set Alpha α</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div style="padding:16px">
                                        <table class="table table-striped table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Asset</th>
                                                    <th>Amount</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="(key, value) in item.setAlpha">
                                                    <td><a href="market/{{key}}" ui-sref="market({id:key})"><b>{{key}}</b></a></td>
                                                    <td>{{value}}</td>
                                                <tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6" style="padding:0px">
                                <div class="card">
                                    <div style="background:url('https://source.unsplash.com/1600x900/?explore,discover,beta,asset');min-height:100px" class="imageContainerSmall">
                                        <div style="background:rgba(0,0,0,0.75);height:100px" class="imageContainerSmallDiv">  
                                            <div style="margin-top: auto;margin-bottom: auto;">
                                                <div style="padding:15px">
                                                    <h2 style="color:white">Set Beta β</h2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div style="padding:16px">
                                        <table class="table table-striped table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Asset</th>
                                                    <th>Amount</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="(key, value) in item.setBeta">
                                                    <td><a href="market/{{key}}" ui-sref="market({id:key})"><b>{{key}}</b></a></td>
                                                    <td>{{value}}</td>
                                                <tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="spacing-10"></div>

                        <cytoscape graph-options="options" graph-elements="item.directedGraph" graph-layout="layout" graph-style="style"></cytoscape>

                        <p style="display:inline;font-size:10px;color:gray;margin-left:5px" am-time-ago="item.createdAt"></p>

                    </div>
                    <div class="card-footer">
                        <a style="color:grey" href="content/{{item.id}}" ui-sref="content({id:item.id})"><i class="fas fa-eye"></i> {{item.attention.general || 0}}</a>
                        <a ng-click="$event.stopPropagation();createReaction(item, 'plus')"><i class="fas fa-angle-up"></i> {{item.reactions.plus}} like </a> 
                        <a ng-click="$event.stopPropagation();createReaction(item, 'minus')" ><i class="fas fa-angle-down"></i> {{item.reactions.minus}} dislike </a>
                        <a ng-click="$event.stopPropagation();reply(item)"><i class="far fa-comment"></i> comment </a>
                        <a ng-click="$event.stopPropagation();" class="pull-right" style="padding:0px;" href="order/{{item.id}}" ui-sref="order({id:item.id})"><i class="fas fa-link grey"></i></a>
                    </div>
                </div>
            </div>

        </div>

        <!--TODO: LIST REACTIONS.. IE RATINGS IF GENERATOR-->
        <!--
        <div class="card" ng-repeat="item in contentList">
            <div style="padding:16px">
                <div>
                    <img class="card-avatar" ng-src="{{item.user.avatarUrl}}" src="{{item.user.avatarUrl}}" err-src="/images/avatar.png">
                    <a style="display:inline;font-weight:600;margin-left:5px" href="member/{{item.user.username}}" ui-sref="member.activity({path:item.user.username})">{{item.user.username}}</a>
                    <p style="display:inline;font-size:10px;color:gray;margin-left:5px" am-time-ago="item.createdAt"></p>
                </div> 
                <div style="margin-left:42px"><span style="display:inline" ng-bind-html="renderContent(item.content)"></span></div>
            </div>
            <div class="" style="padding: 8px 16px 8px;background-color: #f9f9f9">
                <a href="#" style="padding:5px;color:grey" ng-click="createReaction(item, 'plus')"><i class="fa fa-angle-up"></i> {{item.reactions.plus}} like </a> 
                <a href="#" style="padding:5px;color:grey" ng-click="createReaction(item, 'minus')" ><i class="fa fa-angle-down"></i> {{item.reactions.minus}} dislike </a>
                <a href="#" style="padding:5px;color:grey" ng-click="reply(item)"><i class="fa fa-comment-o"></i> comment </a>
                <a style="color:grey" class="pull-right" href="content/{{item.id}}" ui-sref="content({id:item.id})"><i class="fa fa-link grey"></i></a>
            </div>
            <div ng-show="item.showReply" style="padding: 8px 16px 8px;background-color: #f9f9f9">
                <form role="form" ng-submit="createContent(item)">
                    <text-angular ng-model="newContent.content" ta-toolbar="[['p','h1','h2','bold','italics','quote','pre','insertLink', 'html']]"></text-angular>
                    <button type="submit" style="width:100%" class="btn btn-default log-btn" ng-disabled="!newContent.content">create</button>
                </form>
            </div>
        </div>
        -->

    </div>

    <div class="spacing-50"></div>

</div>